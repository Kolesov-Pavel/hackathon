<!DOCTYPE html>
<html>
<head>
  <title>Sentinel-2: Дороги и здания</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <style>
    #map { width: 800px; height: 600px; margin: 20px auto; border: 1px solid #ccc; }
    h2 { text-align: center; font-family: Arial, sans-serif; }
  </style>
</head>
<body>
  <h2>Карта Sentinel-2: Дороги и здания (сегодня)</h2>
  <div id="map"></div>

  <script>
    // Координаты первой метки (72.21289063, 60.49416733)
    const markerCoords1 = [60.49416733, 72.21289063];
    
    // Координаты второй метки (71.46191406, 60.06002808)
    const markerCoords2 = [60.06002808, 71.46191406];
    
    // Сегодняшняя дата (формат YYYY-MM-DD)
    const today = new Date();
    const dateStr = today.toISOString().split('T')[0];

    // Инициализация карты (центр между двумя метками)
    const map = L.map('map').setView(
      [(markerCoords1[0] + markerCoords2[0]) / 2, (markerCoords1[1] + markerCoords2[1]) / 2], 
      8
    );

    // Стиль SWIR для инфраструктуры (B12, B11, B4)
    const urbanStyle = `https://services.sentinel-hub.com/ogc/wms/10084d2d-cc90-4fd3-8c37-8c6f72f892b9?` +
      `SERVICE=WMS` +
      `&REQUEST=GetMap` +
      `&LAYERS=SWIR` +
      `&BBOX=71,60,72.5,60.6` +  // BBOX, охватывающий обе метки
      `&WIDTH=800` +
      `&HEIGHT=600` +
      `&TIME=${dateStr}` +
      `&FORMAT=image/png` +
      `&SHOWLOGO=false`;

    L.tileLayer(urbanStyle, {
      attribution: 'Sentinel-2 © ESA/Sentinel Hub'
    }).addTo(map);

    // Добавляем первую метку
    L.marker(markerCoords1)
      .addTo(map)
      .bindPopup(`<b>Метка 1:</b> 72.21289063, 60.49416733<br><b>Дата:</b> ${dateStr}`)
      .openPopup();

    // Добавляем вторую метку
    L.marker(markerCoords2)
      .addTo(map)
      .bindPopup(`<b>Метка 2:</b> 71.46191406, 60.06002808<br><b>Дата:</b> ${dateStr}`);

    // Добавляем слой OSM для сравнения (один раз)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '© OpenStreetMap'
    }).addTo(map);
  </script>
</body>
</html>
